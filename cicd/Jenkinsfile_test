pipeline {
    agent any
    
    stages {
        stage('Checkout') {
            steps {
                git branch: 'main',
                    credentialsId: 'github_token',
                    url: 'https://github.com/VaibhavSatve/SNOW_DB.git'
            }
        }
        
        stage('Deploy to Dev') {
            environment {
                SNOWFLAKE_ACCOUNT = 'SF_ACCOUNT'
                SNOWFLAKE_USER = 'dev_user'
                SNOWFLAKE_PASSWORD = credentials('snowflake-dev-password')
            }
            steps {
                sh 'snowsql -c "account=${SNOWFLAKE_ACCOUNT} user=${SNOWFLAKE_USER} password=${SNOWFLAKE_PASSWORD}" -f snowflake_scripts/schema_change_script.sql'
            }
        }
        
        stage('Deploy to Stage') {
            environment {
                SNOWFLAKE_ACCOUNT = 'stage_account'
                SNOWFLAKE_USER = 'stage_user'
                SNOWFLAKE_PASSWORD = credentials('snowflake-stage-password')
            }
            steps {
                sh 'snowsql -c "account=${SNOWFLAKE_ACCOUNT} user=${SNOWFLAKE_USER} password=${SNOWFLAKE_PASSWORD}" -f snowflake_scripts/schema_change_script.sql'
            }
        }
        
        stage('Deploy to Prod') {
            environment {
                SNOWFLAKE_ACCOUNT = 'prod_account'
                SNOWFLAKE_USER = 'prod_user'
                SNOWFLAKE_PASSWORD = credentials('snowflake-prod-password')
            }
            steps {
                sh 'snowsql -c "account=${SNOWFLAKE_ACCOUNT} user=${SNOWFLAKE_USER} password=${SNOWFLAKE_PASSWORD}" -f snowflake_scripts/schema_change_script.sql'
            }
        }
    }
}
